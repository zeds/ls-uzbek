<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Youtubeã‚³ãƒ¡ãƒ³ãƒˆ</title>
  </head>

  <style>
    .elem {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 10px;
    }
    .left {
      display: flex;
      align-items: center;
      gap: 5px;
    }
  </style>

  <body>
    <input id="name" type="text" placeholder="Enter your name" />
    <input id="comment" type="text" placeholder="comment here" />
    <button id="commentButton">ã‚³ãƒ¡ãƒ³ãƒˆ</button>
    <button id="clearButton">clear</button>

    <div id="lists">
      <!-- <div class="elem">
				<div>ä½è—¤ å„ªã—ã„äºŒåŒ¹ã«ç™’ã•ã‚Œã¾ã™</div>
				<div>
					<button>ç·¨é›†</button>
					<button>å‰Šé™¤</button>
				</div>
			</div>
			<div class="elem">
				<div>é«˜æ©‹ ã„ã¤ã‚‚ä¸€ç·’ã«å±…ã‚‹äººãŒãã°ã«å±…ã‚Œã°å®‰å¿ƒã™ã‚‹ã‚“ã ã‚ˆã­ã‡ğŸ€</div>
				<div>
					<button>ç·¨é›†</button>
					<button>å‰Šé™¤</button>
				</div>
			</div>
			<div class="elem">
				<div>å±±ç”° ãã†ãªã®ã­ãƒ¼ğŸ˜¢ å®¶æ—ã ã­ğŸ˜­</div>
				<div>
					<button>ç·¨é›†</button>
					<button>å‰Šé™¤</button>
				</div>
			</div> -->
    </div>
    <!-- <div class="elem">ä½è—¤ å„ªã—ã„äºŒåŒ¹ã«ç™’ã•ã‚Œã¾ã™</div>
			1. <div></div> createElement
			2. <div class="elem"></div> className="elem"
			3. <div class="elem">ä½è—¤ å„ªã—ã„äºŒåŒ¹ã«ç™’ã•ã‚Œã¾ã™</div>
			4. parent.appendChild(" <div class="elem">ä½è—¤ å„ªã—ã„äºŒåŒ¹ã«ç™’ã•ã‚Œã¾ã™</div>") -->

    <script>
      let editMode = false;
      let indexComment = 0;

      const comments = [
        {
          id: "4f550e71-9705-42bb-85d9-5826e08780f7",
          name: "ä½è—¤",
          age: 49,
          comment: "å„ªã—ã„äºŒåŒ¹ã«ç™’ã•ã‚Œã¾ã™",
          cntHeart: 0,
          image_url:
            "https://yt3.ggpht.com/lzgaVr4cM4pQwFOucoi5pa4JZJJhBJ32PxqIJtISYXvy054v0JyWA7GoBtVDV5PvDq_1wJncWg=s68-c-k-c0x00ffffff-no-rj",
        },
        {
          id: "0a2c283a-0af7-4089-a9b2-4f2b850b4244",
          name: "é«˜æ©‹",
          age: 25,
          comment: "ã„ã¤ã‚‚ä¸€ç·’ã«å±…ã‚‹äººãŒãã°ã«å±…ã‚Œã°å®‰å¿ƒã™ã‚‹ã‚“ã ã‚ˆã­ã‡ğŸ€",
          cntHeart: 1,
          image_url:
            "https://yt3.ggpht.com/lzgaVr4cM4pQwFOucoi5pa4JZJJhBJ32PxqIJtISYXvy054v0JyWA7GoBtVDV5PvDq_1wJncWg=s68-c-k-c0x00ffffff-no-rj",
        },
        {
          id: "07ae9121-d2c1-4d1d-8034-57a57fc3bbdb",
          name: "å±±ç”°",
          age: 37,
          comment: "ãã†ãªã®ã­ãƒ¼ğŸ˜¢ å®¶æ—ã ã­ğŸ˜­",
          cntHeart: 0,
          image_url:
            "https://yt3.ggpht.com/lzgaVr4cM4pQwFOucoi5pa4JZJJhBJ32PxqIJtISYXvy054v0JyWA7GoBtVDV5PvDq_1wJncWg=s68-c-k-c0x00ffffff-no-rj",
        },
      ];

      // ã‚³ãƒ¡ãƒ³ãƒˆãƒœã‚¿ãƒ³
      document
        .getElementById("commentButton")
        .addEventListener("click", function () {
          let parent = document.getElementById("lists");
          // inputã®å€¤ã‚’å–å¾—
          // ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ { name: xxxx, comment: xxx}
          // commentsã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿½åŠ 
          let name = document.getElementById("name").value;
          let comment = document.getElementById("comment").value;

          if (editMode) {
            // ç·¨é›†ã®æ™‚
            comments[indexComment].name = name;
            comments[indexComment].comment = comment;
            editMode = false;
            document.getElementById("commentButton").innerHTML = "ã‚³ãƒ¡ãƒ³ãƒˆ";
          } else {
            // è¿½åŠ ã®æ™‚
            comments.unshift(obj);
          }

          // ä»Šè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¨ã¦æ¶ˆã™
          clearElements();

          // commentsã‚’è¡¨ç¤º
          showComments();
        });

      document
        .getElementById("clearButton")
        .addEventListener("click", function () {
          clearElements();
          comments.splice(0, comments.length);
        });

      function showComments() {
        let parent = document.getElementById("lists");

        // commentsã‚’è¡¨ç¤ºã—ãŸã„
        for (let i = 0; i < comments.length; i++) {
          let elem = document.createElement("div");
          elem.className = "elem";

          let left = document.createElement("div");
          left.className = "left";

          let img = document.createElement("img");
          img.src = comments[i].image_url;
          img.width = 40;
          img.height = 40;
          left.appendChild(img);
          // elem.appendChild(img);

          // ä½è—¤ 49æ­³
          let comment = document.createElement("div");
          comment.innerHTML =
            comments[i].name +
            " " +
            comments[i].age +
            "æ­³ " +
            comments[i].comment;
          left.appendChild(comment);

          elem.appendChild(left);

          let right = document.createElement("div");

          // ãƒãƒ¼ãƒˆãƒœã‚¿ãƒ³è¿½åŠ 
          let heartButton = document.createElement("button");
          heartButton.innerHTML = "â™¡";
          heartButton.addEventListener("click", function () {
            comments[i].cntHeart++;
            clearElements();
            showComments();
          });

          // ç·¨é›†ãƒœã‚¿ãƒ³
          let editButton = document.createElement("button");
          editButton.innerHTML = "ç·¨é›†";
          editButton.addEventListener("click", function () {
            editMode = true;
            indexComment = i;
            document.getElementById("name").value = comments[i].name;
            document.getElementById("comment").value = comments[i].comment;
            document.getElementById("commentButton").innerHTML = "ç·¨é›†å®Œäº†";
            // comments[i].name = "éˆ´æœ¨";
            // clearElements();
            // showComments();
          });

          // å‰Šé™¤ãƒœã‚¿ãƒ³
          let deleteButton = document.createElement("button");
          deleteButton.innerHTML = "å‰Šé™¤";
          deleteButton.addEventListener("click", function () {
            comments.splice(i, 1);
            clearElements();
            showComments();
          });

          right.appendChild(editButton);
          right.appendChild(deleteButton);
          elem.appendChild(right);

          parent.appendChild(elem);
        }
      }

      function clearElements() {
        const all = document.querySelectorAll(".elem");

        for (let i = 0; i < all.length; i++) {
          all[i].remove();
        }
      }

      // commentsã‚’è¡¨ç¤º
      showComments();
    </script>
  </body>
</html>
